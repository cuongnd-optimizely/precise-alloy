{"version":3,"file":"root.js","sources":["../../../src/assets/scripts/root.entry.ts"],"sourcesContent":["const BORDER_SIZE = 20;\nconst MIN_FRAME_SIZE = 350;\n\nlet orgWidth: number;\nlet pos: number;\n\nconst wrapper = document.getElementById('root-iframe-wrapper')!;\nconst frame = document.getElementById('root-iframe')!;\nconst resizer = document.getElementById('root-iframe-resizer')!;\nconst root = document.getElementById('.xpack-t-root');\n\nconst setIFrameWidth = (width?: number) => {\n  if (width) {\n    wrapper.style.maxWidth = `min(100%, ${width}px)`;\n  } else {\n    wrapper.style.removeProperty('max-width');\n  }\n};\n\nconst resize = (e: globalThis.MouseEvent) => {\n  e.stopPropagation();\n  e.preventDefault();\n  e.cancelBubble = true;\n  const dx = (e.x - pos) * 2;\n\n  const size = Math.max(MIN_FRAME_SIZE, orgWidth + dx);\n  setIFrameWidth(size);\n\n  return false;\n};\n\nconst mouseUp = () => {\n  wrapper.style.removeProperty('transition');\n  frame.style.removeProperty('pointer-events');\n\n  document.removeEventListener('mousemove', resize, false);\n};\n\nconst handleResizerMouseDown = (e: MouseEvent) => {\n  if (e.offsetX >= BORDER_SIZE) {\n    return;\n  }\n\n  wrapper.style.transition = 'none';\n  frame.style.pointerEvents = 'none';\n  pos = e.x;\n  orgWidth = parseInt(getComputedStyle(wrapper, '').width);\n  document.addEventListener('mousemove', resize, false);\n  document.addEventListener('mouseup', mouseUp, false);\n};\n\nconst initTopPanel = () => {\n  const isTopPanel = localStorage.getItem('MSG_IS_TOP_PANEL') === 'true';\n  let rootEl = document.querySelector('.xpack-t-root');\n\n  if (!rootEl) {\n    return;\n  }\n  if (isTopPanel) {\n    rootEl.classList.add('top-panel');\n  }\n};\n\nconst handleStoreModified = (event: StorageEvent) => {\n  switch (event.key) {\n    case 'MSG_IS_TOP_PANEL':\n      const isTopPanel = event.newValue === 'true';\n      let rootEl = document.querySelector('.xpack-t-root');\n\n      if (!rootEl) {\n        return;\n      }\n\n      if (isTopPanel) {\n        rootEl.classList.add('top-panel');\n      } else {\n        rootEl.classList.remove('top-panel');\n      }\n      break;\n  }\n};\n\nconst addStoreEvent = () => {\n  window.addEventListener('storage', handleStoreModified);\n};\n\nconst setup = () => {\n  resizer.onmousedown = handleResizerMouseDown;\n\n  const getIFrameActualWidth = () => {\n    const el = document.getElementById('root-actual-iframe-width');\n    if (el) {\n      el.textContent = Math.ceil(parseInt(getComputedStyle(frame).width)) + 'px';\n    }\n  };\n\n  frame.onload = getIFrameActualWidth;\n\n  if ('ResizeObserver' in window) {\n    // create an Observer instance\n    const resizeObserver = new ResizeObserver(getIFrameActualWidth);\n\n    // start observing a DOM node\n    resizeObserver.observe(frame);\n  }\n  initTopPanel();\n  addStoreEvent();\n};\n\nsetup();\n\nexport { };\n"],"names":["orgWidth","pos","wrapper","frame","resizer","setIFrameWidth","width","resize","dx","size","mouseUp","handleResizerMouseDown","initTopPanel","isTopPanel","rootEl","handleStoreModified","event","addStoreEvent","setup","getIFrameActualWidth","el"],"mappings":"AAGA,IAAIA,GACAC;AAEJ,MAAMC,IAAU,SAAS,eAAe,qBAAqB,GACvDC,IAAQ,SAAS,eAAe,aAAa,GAC7CC,IAAU,SAAS,eAAe,qBAAqB;AAChD,SAAS,eAAe,eAAe;AAEpD,MAAMC,IAAiB,CAACC,MAAmB;AACzC,EAAIA,IACMJ,EAAA,MAAM,WAAW,aAAaI,SAE9BJ,EAAA,MAAM,eAAe,WAAW;AAE5C,GAEMK,IAAS,CAAC,MAA6B;AAC3C,IAAE,gBAAgB,GAClB,EAAE,eAAe,GACjB,EAAE,eAAe;AACX,QAAAC,KAAM,EAAE,IAAIP,KAAO,GAEnBQ,IAAO,KAAK,IAAI,KAAgBT,IAAWQ,CAAE;AACnD,SAAAH,EAAeI,CAAI,GAEZ;AACT,GAEMC,IAAU,MAAM;AACZ,EAAAR,EAAA,MAAM,eAAe,YAAY,GACnCC,EAAA,MAAM,eAAe,gBAAgB,GAElC,SAAA,oBAAoB,aAAaI,GAAQ,EAAK;AACzD,GAEMI,IAAyB,CAAC,MAAkB;AAC5C,EAAA,EAAE,WAAW,OAIjBT,EAAQ,MAAM,aAAa,QAC3BC,EAAM,MAAM,gBAAgB,QAC5BF,IAAM,EAAE,GACRD,IAAW,SAAS,iBAAiBE,GAAS,EAAE,EAAE,KAAK,GAC9C,SAAA,iBAAiB,aAAaK,GAAQ,EAAK,GAC3C,SAAA,iBAAiB,WAAWG,GAAS,EAAK;AACrD,GAEME,IAAe,MAAM;AACzB,QAAMC,IAAa,aAAa,QAAQ,kBAAkB,MAAM;AAC5D,MAAAC,IAAS,SAAS,cAAc,eAAe;AAEnD,EAAKA,KAGDD,KACKC,EAAA,UAAU,IAAI,WAAW;AAEpC,GAEMC,IAAsB,CAACC,MAAwB;AACnD,UAAQA,EAAM,KAAK;AAAA,IACjB,KAAK;AACG,YAAAH,IAAaG,EAAM,aAAa;AAClC,UAAAF,IAAS,SAAS,cAAc,eAAe;AAEnD,UAAI,CAACA;AACH;AAGF,MAAID,IACKC,EAAA,UAAU,IAAI,WAAW,IAEzBA,EAAA,UAAU,OAAO,WAAW;AAErC;AAAA,EACJ;AACF,GAEMG,IAAgB,MAAM;AACnB,SAAA,iBAAiB,WAAWF,CAAmB;AACxD,GAEMG,IAAQ,MAAM;AAClB,EAAAd,EAAQ,cAAcO;AAEtB,QAAMQ,IAAuB,MAAM;AAC3B,UAAAC,IAAK,SAAS,eAAe,0BAA0B;AAC7D,IAAIA,MACCA,EAAA,cAAc,KAAK,KAAK,SAAS,iBAAiBjB,CAAK,EAAE,KAAK,CAAC,IAAI;AAAA,EACxE;AAGF,EAAAA,EAAM,SAASgB,GAEX,oBAAoB,UAEC,IAAI,eAAeA,CAAoB,EAG/C,QAAQhB,CAAK,GAEjBS,KACCK;AAChB;AAEAC,EAAM;"}
{"version":3,"file":"root.js","sources":["../../../src/assets/scripts/root.entry.ts"],"sourcesContent":["const BORDER_SIZE = 20;\nconst MIN_FRAME_SIZE = 350;\n\nlet orgWidth: number;\nlet pos: number;\n\nconst wrapper = document.getElementById('root-iframe-wrapper')!;\nconst frame = document.getElementById('root-iframe')!;\nconst resizer = document.getElementById('root-iframe-resizer')!;\nconst root = document.getElementById('.xpack-t-root');\n\nconst setIFrameWidth = (width?: number) => {\n  if (width) {\n    wrapper.style.maxWidth = `min(100%, ${width}px)`;\n  } else {\n    wrapper.style.removeProperty('max-width');\n  }\n};\n\nconst resize = (e: globalThis.MouseEvent) => {\n  e.stopPropagation();\n  e.preventDefault();\n  e.cancelBubble = true;\n  const dx = (e.x - pos) * 2;\n\n  const size = Math.max(MIN_FRAME_SIZE, orgWidth + dx);\n  setIFrameWidth(size);\n\n  return false;\n};\n\nconst mouseUp = () => {\n  wrapper.style.removeProperty('transition');\n  frame.style.removeProperty('pointer-events');\n\n  document.removeEventListener('mousemove', resize, false);\n};\n\nconst handleResizerMouseDown = (e: MouseEvent) => {\n  if (e.offsetX >= BORDER_SIZE) {\n    return;\n  }\n\n  wrapper.style.transition = 'none';\n  frame.style.pointerEvents = 'none';\n  pos = e.x;\n  orgWidth = parseInt(getComputedStyle(wrapper, '').width);\n  document.addEventListener('mousemove', resize, false);\n  document.addEventListener('mouseup', mouseUp, false);\n};\n\nconst initTopPanel = () => {\n  const isTopPanel = localStorage.getItem('MSG_IS_TOP_PANEL') === 'true';\n  let rootEl = document.querySelector('.xpack-t-root');\n\n  if (!rootEl) {\n    return;\n  }\n  if (isTopPanel) {\n    rootEl.classList.add('top-panel');\n  }\n};\n\nconst handleStoreModified = (event: StorageEvent) => {\n  switch (event.key) {\n    case 'MSG_IS_TOP_PANEL':\n      const isTopPanel = event.newValue === 'true';\n      let rootEl = document.querySelector('.xpack-t-root');\n\n      if (!rootEl) {\n        return;\n      }\n\n      if (isTopPanel) {\n        rootEl.classList.add('top-panel');\n      } else {\n        rootEl.classList.remove('top-panel');\n      }\n      break;\n  }\n};\n\nconst addStoreEvent = () => {\n  window.addEventListener('storage', handleStoreModified);\n};\n\nconst setup = () => {\n  resizer.onmousedown = handleResizerMouseDown;\n\n  const getIFrameActualWidth = () => {\n    const el = document.getElementById('root-actual-iframe-width');\n    if (el) {\n      el.textContent = Math.ceil(parseInt(getComputedStyle(frame).width)) + 'px';\n    }\n  };\n\n  frame.onload = getIFrameActualWidth;\n\n  if ('ResizeObserver' in window) {\n    // create an Observer instance\n    const resizeObserver = new ResizeObserver(getIFrameActualWidth);\n\n    // start observing a DOM node\n    resizeObserver.observe(frame);\n  }\n  initTopPanel();\n  addStoreEvent();\n};\n\nsetup();\n\nexport { };\n"],"names":["orgWidth","pos","wrapper","frame","resizer","setIFrameWidth","width","resize","dx","size","mouseUp","handleResizerMouseDown","initTopPanel","isTopPanel","rootEl","handleStoreModified","event","addStoreEvent","setup","getIFrameActualWidth","el"],"mappings":"AAGA,IAAIA,EACAC,EAEJ,MAAMC,EAAU,SAAS,eAAe,qBAAqB,EACvDC,EAAQ,SAAS,eAAe,aAAa,EAC7CC,EAAU,SAAS,eAAe,qBAAqB,EAChD,SAAS,eAAe,eAAe,EAEpD,MAAMC,EAAkBC,GAAmB,CACrCA,EACMJ,EAAA,MAAM,SAAW,aAAaI,OAE9BJ,EAAA,MAAM,eAAe,WAAW,CAE5C,EAEMK,EAAU,GAA6B,CAC3C,EAAE,gBAAgB,EAClB,EAAE,eAAe,EACjB,EAAE,aAAe,GACX,MAAAC,GAAM,EAAE,EAAIP,GAAO,EAEnBQ,EAAO,KAAK,IAAI,IAAgBT,EAAWQ,CAAE,EACnD,OAAAH,EAAeI,CAAI,EAEZ,EACT,EAEMC,EAAU,IAAM,CACZR,EAAA,MAAM,eAAe,YAAY,EACnCC,EAAA,MAAM,eAAe,gBAAgB,EAElC,SAAA,oBAAoB,YAAaI,EAAQ,EAAK,CACzD,EAEMI,EAA0B,GAAkB,CAC5C,EAAE,SAAW,KAIjBT,EAAQ,MAAM,WAAa,OAC3BC,EAAM,MAAM,cAAgB,OAC5BF,EAAM,EAAE,EACRD,EAAW,SAAS,iBAAiBE,EAAS,EAAE,EAAE,KAAK,EAC9C,SAAA,iBAAiB,YAAaK,EAAQ,EAAK,EAC3C,SAAA,iBAAiB,UAAWG,EAAS,EAAK,EACrD,EAEME,EAAe,IAAM,CACzB,MAAMC,EAAa,aAAa,QAAQ,kBAAkB,IAAM,OAC5D,IAAAC,EAAS,SAAS,cAAc,eAAe,EAE9CA,GAGDD,GACKC,EAAA,UAAU,IAAI,WAAW,CAEpC,EAEMC,EAAuBC,GAAwB,CACnD,OAAQA,EAAM,IAAK,CACjB,IAAK,mBACG,MAAAH,EAAaG,EAAM,WAAa,OAClC,IAAAF,EAAS,SAAS,cAAc,eAAe,EAEnD,GAAI,CAACA,EACH,OAGED,EACKC,EAAA,UAAU,IAAI,WAAW,EAEzBA,EAAA,UAAU,OAAO,WAAW,EAErC,KACJ,CACF,EAEMG,EAAgB,IAAM,CACnB,OAAA,iBAAiB,UAAWF,CAAmB,CACxD,EAEMG,EAAQ,IAAM,CAClBd,EAAQ,YAAcO,EAEtB,MAAMQ,EAAuB,IAAM,CAC3B,MAAAC,EAAK,SAAS,eAAe,0BAA0B,EACzDA,IACCA,EAAA,YAAc,KAAK,KAAK,SAAS,iBAAiBjB,CAAK,EAAE,KAAK,CAAC,EAAI,KACxE,EAGFA,EAAM,OAASgB,EAEX,mBAAoB,QAEC,IAAI,eAAeA,CAAoB,EAG/C,QAAQhB,CAAK,EAEjBS,IACCK,GAChB,EAEAC,EAAM"}